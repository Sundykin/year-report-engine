# Year Report Engine 开发规划

## 当前状态概览

### 已实现功能
- 核心类型系统（text/image/shape/chart/video/richtext/button/icon/divider/progress/counter/countdown/list/tag/table/carousel）
- Vue3 设计器（组件面板、属性面板、画布编辑、动画配置、数据源管理）
- 三端渲染器（Vue3/Vue2/React）
- 动画系统（animate.css 预设 + anime.js 关键帧）
- 数据绑定（静态/异步数据源、插值语法）
- 分组操作（创建/解散/移动/缩放/旋转）
- 智能吸附对齐
- 项目导出（ZIP）
- ✅ 撤销/重做系统（Ctrl+Z / Ctrl+Shift+Z）
- ✅ 复制粘贴增强（Ctrl+C/V/X，复制样式 Ctrl+Shift+C/V）
- ✅ 对齐分布工具（多选对齐、等间距分布）
- ✅ 图层面板（拖拽排序、可见性、锁定）
- ✅ Schema Form 动态表单系统（所有组件属性面板统一配置化）
- ✅ 新组件：按钮、图标、分割线、进度条、计数器、倒计时、列表、标签、表格、轮播图
- ✅ 文本增强：文字描边、阴影、渐变填充
- ✅ 图片增强：滤镜效果、蒙版形状、翻转

---

## Phase 1: 核心功能完善（优先级：高）✅ 已完成

### 1.1 撤销/重做系统 ✅
- [x] 实现操作历史栈（useHistory composable）
- [x] 支持 Ctrl+Z / Ctrl+Shift+Z 快捷键
- [x] 批量操作合并（如连续移动合并为一次）
- [x] 历史记录上限配置

### 1.2 复制粘贴增强 ✅
- [x] 跨页面复制粘贴
- [x] 复制样式（Ctrl+Shift+C/V）
- [x] 批量复制（多选元素）
- [x] 剪切功能（Ctrl+X）

### 1.3 对齐分布工具 ✅
- [x] 多选元素对齐（左/中/右/上/中/下）
- [x] 等间距分布（水平/垂直）
- [x] 对齐到画布中心
- [x] 工具栏快捷按钮

### 1.4 图层面板 ✅
- [x] 独立图层面板组件
- [x] 拖拽调整图层顺序
- [x] 图层可见性切换
- [x] 图层锁定状态显示

---

## Phase 8: 动态表单属性面板（优先级：高）✅ 已完成

> Schema Form 系统已实现，大幅简化组件属性面板开发

### 8.1 基础架构 ✅
- [x] 定义 FormSchema 类型系统（types.ts）
- [x] 创建 SchemaForm.vue 动态表单组件
- [x] 实现字段路径解析（支持 `style.color` 嵌套路径）
- [x] 支持联动显示逻辑（showWhen）

### 8.2 原子控件库 ✅
- [x] NumberInput - 数值输入
- [x] TextInput - 文本输入
- [x] TextareaInput - 多行文本
- [x] ColorPicker - 颜色选择
- [x] SelectInput - 下拉选择
- [x] CheckboxInput - 开关
- [x] RangeSlider - 滑块
- [x] ButtonGroup - 按钮组
- [x] DatetimeInput - 日期时间
- [x] FileUpload - 文件上传

### 8.3 布局组件 ✅
- [x] FormSection - 分组区域（带标题）
- [x] 网格布局（grid 配置）
- [x] 可折叠区域（collapsible）

### 8.4 组件 Schema 配置 ✅
已完成所有组件的 schema 迁移：
- [x] common - 通用属性（位置、锁定）
- [x] text - 文本组件
- [x] richtext - 富文本组件
- [x] image-video - 图片/视频组件
- [x] shape - 形状组件
- [x] chart - 图表组件
- [x] icon - 图标组件
- [x] progress - 进度条组件
- [x] counter - 计数器组件
- [x] countdown - 倒计时组件
- [x] list - 列表组件
- [x] tag - 标签组件
- [x] style-effects - 样式效果

---

## Phase 2: 组件库扩展（优先级：高）🚧 进行中

> 参考：易企秀、MAKA、兔展、创客贴、Canva、稿定设计等商业化产品

### 2.1 基础组件增强

**文本组件**
- [ ] 文字描边效果
- [ ] 文字阴影
- [ ] 渐变文字填充
- [ ] 艺术字预设模板
- [ ] 文字路径（沿曲线排列）

**图片组件**
- [ ] 图片裁剪（自由/比例）
- [ ] 滤镜效果（灰度/模糊/对比度/饱和度）
- [ ] 图片蒙版（圆形/多边形/自定义）
- [ ] 边框样式（实线/虚线/阴影）
- [ ] 图片翻转（水平/垂直）

**形状组件**
- [x] 更多预设形状（箭头/对话框/标注/徽章）
- [ ] 自定义路径绘制
- [ ] 形状组合（布尔运算）
- [ ] 渐变填充

### 2.2 新增基础组件 ✅ 部分完成

**按钮组件** `button` ✅
- [x] 多种按钮样式（实心/描边/文字）
- [x] 图标+文字组合
- [x] 点击事件（跳转链接/拨打电话/发送邮件）

**图标组件** `icon` ✅
- [x] 内置图标库（基础图标）
- [x] 自定义颜色和大小

**分割线组件** `divider` ✅
- [x] 实线/虚线/点线
- [x] 带文字分割线

**容器组件** `container`
- [ ] 背景色/背景图
- [ ] 圆角/阴影
- [ ] 内边距配置
- [ ] 子元素布局（自由/flex）

### 2.3 数据展示组件 ✅ 大部分完成

**进度条** `progress` ✅
- [x] 条形进度条
- [x] 环形进度条
- [ ] 半圆进度条
- [ ] 动画效果
- [ ] 数据绑定

**计数器** `counter` ✅
- [x] 数字滚动动画
- [x] 前缀/后缀单位
- [x] 小数位配置
- [ ] 千分位格式化

**倒计时** `countdown` ✅
- [x] 天/时/分/秒显示
- [x] 自定义格式
- [ ] 结束回调

**表格** `table`
- [ ] 表头配置
- [ ] 斑马纹
- [ ] 数据绑定
- [ ] 滚动支持

**列表** `list` ✅
- [x] 有序/无序列表
- [x] 自定义图标颜色
- [ ] 数据绑定循环

**标签** `tag` ✅
- [x] 多种颜色预设
- [x] 多种样式变体（实心/描边/浅色）
- [ ] 可关闭标签
- [ ] 标签组

### 2.4 交互组件

**轮播图** `carousel`
- [ ] 图片/内容轮播
- [ ] 自动播放
- [ ] 指示器样式
- [ ] 切换动画

**选项卡** `tabs`
- [ ] 顶部/底部选项卡
- [ ] 滑动切换
- [ ] 自定义样式

**折叠面板** `collapse`
- [ ] 手风琴模式
- [ ] 展开/收起动画
- [ ] 自定义图标

**弹窗** `modal`
- [ ] 点击触发弹窗
- [ ] 自定义内容
- [ ] 关闭按钮
- [ ] 遮罩层

**抽屉** `drawer`
- [ ] 左/右/上/下滑出
- [ ] 自定义宽度

### 2.5 营销组件

**抽奖转盘** `lottery`
- [ ] 转盘样式配置
- [ ] 奖品配置
- [ ] 中奖概率
- [ ] 抽奖次数限制

**红包雨** `redpacket`
- [ ] 红包样式
- [ ] 下落动画
- [ ] 点击领取

**优惠券** `coupon`
- [ ] 多种券样式
- [ ] 有效期显示
- [ ] 领取状态

**投票** `vote`
- [ ] 单选/多选
- [ ] 实时结果展示
- [ ] 投票限制

### 2.6 表单组件

**输入框** `input`
- [ ] 单行/多行
- [ ] 占位符
- [ ] 验证规则
- [ ] 数据绑定

**选择器** `select`
- [ ] 下拉选择
- [ ] 单选/多选
- [ ] 搜索过滤

**开关** `switch`
- [ ] 开关状态
- [ ] 自定义颜色

**滑块** `slider`
- [ ] 数值范围
- [ ] 步进值
- [ ] 显示当前值

**评分** `rate`
- [ ] 星星/心形/自定义图标
- [ ] 半星支持
- [ ] 只读模式

### 2.7 媒体组件增强

**音频** `audio`
- [ ] 播放器样式
- [ ] 播放控制
- [ ] 自动播放

**Lottie动画** `lottie`
- [ ] JSON 动画文件支持
- [ ] 播放控制
- [ ] 循环配置

**GIF** `gif`
- [ ] GIF 播放控制
- [ ] 首帧预览

### 2.8 图表组件增强

- [ ] 雷达图
- [ ] 漏斗图
- [ ] 仪表盘
- [ ] 词云图
- [ ] 地图（省份/城市）
- [ ] 图表主题配置
- [ ] 图表动画配置
- [ ] 数据标签显示

---

## Phase 2.5: 组件渲染逻辑控制（优先级：高）

### 条件渲染
- [ ] 显示条件配置（基于数据源字段）
- [ ] 比较运算符（等于/不等于/大于/小于/包含）
- [ ] 逻辑运算符（与/或/非）
- [ ] 多条件组合

### 循环渲染
- [ ] 基于数组数据源循环生成元素
- [ ] 循环变量绑定（item/index）
- [ ] 循环内元素模板
- [ ] 空数据占位

### 状态切换
- [ ] 元素多状态配置（默认/悬停/激活/禁用）
- [ ] 状态切换动画
- [ ] 状态间属性差异

### 事件系统
- [ ] 点击事件
- [ ] 长按事件
- [ ] 滑动事件
- [ ] 事件动作（跳转/弹窗/切换状态/触发动画）

---

## Phase 3: 动画系统升级（优先级：中）

### 3.1 动画编辑器优化
- [ ] 可视化时间轴编辑
- [ ] 动画曲线编辑器（贝塞尔曲线）
- [ ] 动画预览速度控制
- [ ] 动画模板库

### 3.2 新增动画类型
- [ ] 路径动画（沿路径移动）
- [ ] 弹性动画（spring physics）
- [ ] 粒子效果
- [ ] 打字机效果
- [ ] 数字滚动效果

### 3.3 交互动画
- [ ] 滚动触发动画
- [ ] 手势触发（滑动/长按）
- [ ] 元素间联动动画
- [ ] 页面切换动画增强

---

## Phase 4: 数据能力增强（优先级：中）

### 4.1 数据源管理
- [ ] 数据源分组管理
- [ ] 数据源导入导出
- [ ] 数据预览和调试
- [ ] 请求错误处理和重试

### 4.2 数据绑定增强
- [ ] 条件渲染（v-if 类似）
- [ ] 列表渲染（v-for 类似）
- [ ] 数据格式化（日期/数字/货币）
- [ ] 计算属性支持

### 4.3 实时数据
- [ ] WebSocket 数据源支持
- [ ] 数据轮询优化
- [ ] 数据变化动画

---

## Phase 5: 导出与发布（优先级：中）

### 5.1 导出格式扩展
- [ ] 导出为图片（PNG/JPG）
- [ ] 导出为 PDF
- [ ] 导出为视频（MP4）
- [ ] 导出为独立 HTML

### 5.2 发布功能
- [ ] 一键发布到 CDN
- [ ] 生成分享链接
- [ ] 二维码生成
- [ ] 访问统计集成

### 5.3 嵌入支持
- [ ] iframe 嵌入代码生成
- [ ] Web Component 封装
- [ ] SDK 集成文档

---

## Phase 6: 用户体验优化（优先级：中）

### 6.1 设计器优化
- [ ] 深色/浅色主题切换
- [ ] 自定义快捷键配置
- [ ] 工作区布局保存
- [ ] 最近项目列表

### 6.2 性能优化
- [ ] 大量元素虚拟滚动
- [ ] 画布渲染优化（离屏 Canvas）
- [ ] 资源懒加载
- [ ] 操作防抖节流

### 6.3 辅助功能
- [ ] 网格显示/隐藏
- [ ] 参考线手动添加
- [ ] 元素搜索定位
- [ ] 快捷键提示面板

---

## Phase 7: 模板与资源（优先级：低）

### 7.1 模板系统
- [ ] 内置模板库
- [ ] 模板分类管理
- [ ] 模板预览
- [ ] 自定义模板保存

### 7.2 资源库
- [ ] 图片素材库
- [ ] 图标库集成
- [ ] 字体库管理
- [ ] 配色方案库

---

## 技术债务清理

### 代码质量
- [ ] 完善 TypeScript 类型定义
- [ ] 添加单元测试（Vitest）
- [ ] 添加 E2E 测试（Playwright）
- [ ] ESLint/Prettier 配置统一

### 文档完善
- [ ] API 文档生成
- [ ] 组件使用文档
- [ ] 开发者指南
- [ ] 部署文档

### 构建优化
- [ ] 修复 vue-tsc 版本兼容问题
- [ ] 优化打包体积
- [ ] Tree-shaking 优化
- [ ] 按需加载配置

---

## 建议开发顺序

### 当前优先（Phase 2 继续）
1. **文本增强**：文字描边、阴影、渐变填充
2. **图片增强**：裁剪、滤镜、蒙版
3. **表格组件**：数据展示核心组件
4. **轮播图组件**：交互组件

### 短期目标（Phase 2.5 + Phase 3）
1. **条件/循环渲染**：动态内容能力
2. **事件系统**：交互动作
3. **动画编辑器优化**：可视化时间轴

### 中期目标（Phase 4 + Phase 5）
1. **数据能力增强**
2. **导出格式扩展**
3. **发布功能**

### 长期目标（Phase 6 + Phase 7）
1. **用户体验优化**
2. **模板与资源系统**

---

## 里程碑规划

### v1.1 - 编辑体验优化 ✅
- ✅ 撤销/重做
- ✅ 对齐分布
- ✅ 图层面板
- ✅ 复制粘贴增强
- ✅ Schema Form 动态表单

### v1.2 - 组件能力扩展（当前版本）
- ✅ 进度条/计数器/倒计时组件
- ✅ 列表/标签组件
- [ ] 文本/图片增强
- [ ] 表格组件
- [ ] 轮播图组件

### v1.3 - 动画与交互
- [ ] 条件/循环渲染
- [ ] 事件系统
- [ ] 动画编辑器升级
- [ ] 交互动画

### v2.0 - 发布与协作
- [ ] 多格式导出
- [ ] 发布功能
- [ ] 模板系统
